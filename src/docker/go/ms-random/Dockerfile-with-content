FROM com.gft.deuba.unity.release-1.application.ms-measure:base

ARG GITHASH
ARG TIMESTAMP
ARG COMPONENT
ARG MODULE
ARG CUSTOMER
ARG PROJECT

ENV GITHASH=$GITHASH
ENV TIMESTAMP=$TIMESTAMP
ENV COMPONENT=$COMPONENT
ENV MODULE=$MODULE
ENV CUSTOMER=$CUSTOMER
ENV PROJECT=$PROJECT

USER root
RUN apk --update add curl bind-tools bash vim strace ltrace
RUN mkdir -p /workdir
RUN chown -R ${COMPONENT}:${COMPONENT} /workdir && \
    chmod -R o-rwX,g-wX,u=rwX /workdir

LABEL GITHASH=${GITHASH}
LABEL TIMESTAMP=${TIMESTAMP}
LABEL COMPONENT=${COMPONENT}
LABEL MODULE=${MODULE}
LABEL CUSTOMER=${CUSTOMER}
LABEL PROJECT=${PROJECT}

USER ${COMPONENT}
WORKDIR /opt
ENTRYPOINT [ "/opt/component" ]

